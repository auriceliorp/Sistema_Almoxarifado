{% extends 'base_simplificada.html' %}

{% block title %}Mapa de Fechamento Mensal{% endblock %}

{% block content %}

<div class="container mt-4">{# -------------------- CARDS RESUMO -------------------- #}

  <div class="row mb-4">
    <div class="col-md-3">
      <div class="card text-bg-primary text-center shadow">
        <div class="card-body">
          <i class="bi bi-cash-coin display-6"></i>
          <h6 class="mt-2">Saldo Inicial</h6>
          <h4>R$ {{ total_saldo_inicial | round(2) }}</h4>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-bg-success text-center shadow">
        <div class="card-body">
          <i class="bi bi-arrow-down-circle display-6"></i>
          <h6 class="mt-2">Total Entradas</h6>
          <h4>R$ {{ total_entradas | round(2) }}</h4>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-bg-danger text-center shadow">
        <div class="card-body">
          <i class="bi bi-arrow-up-circle display-6"></i>
          <h6 class="mt-2">Total Saídas</h6>
          <h4>R$ {{ total_saidas | round(2) }}</h4>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-bg-warning text-center shadow">
        <div class="card-body">
          <i class="bi bi-wallet2 display-6"></i>
          <h6 class="mt-2">Saldo Final</h6>
          <h4>R$ {{ total_saldo_final | round(2) }}</h4>
        </div>
      </div>
    </div>
  </div>{# -------------------- TABELA -------------------- #}

  <div class="table-responsive">
    <table class="table table-striped align-middle">
      <thead class="table-light sticky-top">
        <tr>
          <th><i class="bi bi-hash"></i> Código ND</th>
          <th><i class="bi bi-card-text"></i> Nome</th>
          <th><i class="bi bi-cash"></i> Saldo Inicial</th>
          <th><i class="bi bi-arrow-down"></i> Entradas</th>
          <th><i class="bi bi-arrow-up"></i> Saídas</th>
          <th><i class="bi bi-wallet"></i> Saldo Final</th>
        </tr>
      </thead>
      <tbody>
        {% for row in dados %}
        <tr>
          <td>{{ row.codigo }}</td>
          <td>{{ row.nome }}</td>
          <td>R$ {{ row.saldo_inicial | round(2) }}</td>
          <td>R$ {{ row.entradas | round(2) }}</td>
          <td>R$ {{ row.saidas | round(2) }}</td>
          <td class="{% if row.saldo_final < 0 %}text-danger fw-bold{% endif %}">
            R$ {{ row.saldo_final | round(2) }}
          </td>
        </tr>
        {% else %}
        <tr><td colspan="6" class="text-center text-muted">Nenhum dado encontrado para o período.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>{# -------------------- BOTÕES -------------------- #}

  <div class="d-flex justify-content-end mt-4 gap-2">
    <a href="{{ url_for('relatorio_bp.exportar_excel') }}" class="btn btn-success btn-lg shadow-sm">
      <i class="bi bi-file-earmark-excel"></i> Excel
    </a>
    <a href="{{ url_for('relatorio_bp.exportar_pdf') }}" class="btn btn-danger btn-lg shadow-sm">
      <i class="bi bi-file-earmark-pdf"></i> PDF
    </a>
    <a href="{{ url_for('relatorio_bp.imprimir_html') }}" class="btn btn-secondary btn-lg shadow-sm">
      <i class="bi bi-printer"></i> Imprimir
    </a>
  </div>
</div><style>
  .sticky-top th {
    position: sticky;
    top: 0;
    background: white;
    z-index: 10;
  }
  .btn-lg {
    transition: transform 0.2s ease;
  }
  .btn-lg:hover {
    transform: scale(1.05);
  }
</style>{% endblock %}

