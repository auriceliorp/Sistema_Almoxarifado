{% extends "base.html" %}

{% block title %}Itens - Almoxarifado{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Itens Cadastrados</h2>
    <a href="{{ url_for("main.criar_item") }}" class="btn btn-success">+ Novo Item</a>
</div>

{# TODO: Adicionar filtros (por ND, status) #}

{% if itens %}
<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th scope="col">Nome</th>
            <th scope="col">Unidade</th>
            <th scope="col">Natureza de Despesa</th>
            <th scope="col">Saldo Atual</th>
            <th scope="col">Est. Mínimo</th>
            <th scope="col">Status</th>
            <th scope="col">Ações</th>
        </tr>
    </thead>
    <tbody>
        {% for item in itens %}
        <tr>
            <td>{{ item.nome }}</td>
            <td>{{ item.unidade_medida }}</td>
            <td>{{ item.natureza_despesa.codigo }} - {{ item.natureza_despesa.descricao }}</td>
            <td>{{ item.saldo_atual }}</td>
            <td>{{ item.estoque_minimo }}</td>
            <td>
                {% if item.ativo %}
                    <span class="badge bg-success">Ativo</span>
                {% else %}
                    <span class="badge bg-secondary">Inativo</span>
                {% endif %}
            </td>
            <td>
                <a href="{{ url_for("main.editar_item", id=item.id) }}" class="btn btn-sm btn-outline-primary">Editar</a>
                {# <a href="{{ url_for("main.detalhes_item", id=item.id) }}" class="btn btn-sm btn-outline-info">Detalhes</a> #} {# Rota a ser criada se necessário #}
                <form action="{{ url_for("main.excluir_item", id=item.id) }}" method="POST" class="d-inline" onsubmit="return confirm("Tem certeza que deseja excluir este Item? Verifique se não há movimentos ou requisições associadas. Considere inativá-lo.");">
                    <button type="submit" class="btn btn-sm btn-outline-danger">Excluir</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div class="alert alert-info" role="alert">
    Nenhum item cadastrado ainda.
</div>
{% endif %}

{% endblock %}

