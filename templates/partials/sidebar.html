{# Conteúdo reutilizável do sidebar para desktop e offcanvas #}
{% if usuario %}
<div class="d-flex align-items-center mb-4 ps-3">
  <i class="bi bi-person-circle fs-4 me-2"></i>
  <strong>{{ usuario.nome }}</strong>
</div>
{% endif %}

<ul class="nav flex-column">
  <!-- Almoxarifado -->
  <li class="nav-item">
    <a class="nav-link text-white fw-bold d-flex justify-content-between align-items-center"
       data-bs-toggle="collapse" href="#submenuAlmox" role="button"
       aria-expanded="{% if request.endpoint.startswith('item_bp') or request.endpoint.startswith('fornecedor_bp') or request.endpoint.startswith('entrada_bp') or request.endpoint.startswith('saida') or request.endpoint == 'main.relatorios' %}true{% else %}false{% endif %}">
      <span><i class="bi bi-archive me-1"></i> Almoxarifado</span><i class="bi bi-chevron-down"></i>
    </a>
    <ul class="collapse nav flex-column ms-3 {% if request.endpoint.startswith('item_bp') or request.endpoint.startswith('fornecedor_bp') or request.endpoint.startswith('entrada_bp') or request.endpoint.startswith('saida') or request.endpoint == 'main.relatorios' %}show{% endif %}" id="submenuAlmox">
      <li class="nav-item"><a href="{{ url_for('item_bp.lista_itens') }}" class="nav-link {% if request.endpoint == 'item_bp.lista_itens' %}active{% endif %} text-white"><i class="bi bi-box me-2"></i>Itens</a></li>
      <li class="nav-item"><a href="{{ url_for('fornecedor_bp.lista_fornecedor') }}" class="nav-link {% if request.endpoint == 'fornecedor_bp.lista_fornecedor' %}active{% endif %} text-white"><i class="bi bi-shop me-2"></i>Fornecedores</a></li>
      <li class="nav-item"><a href="{{ url_for('entrada_bp.lista_entradas') }}" class="nav-link {% if request.endpoint == 'entrada_bp.lista_entradas' %}active{% endif %} text-white"><i class="bi bi-box-arrow-in-down me-2"></i>Entrada de Materiais</a></li>
      <li class="nav-item"><a href="{{ url_for('saida_bp.listar_saidas') }}" class="nav-link {% if request.endpoint == 'saida_bp.listar_saidas' %}active{% endif %} text-white"><i class="bi bi-box-arrow-up me-2"></i>Saída de Materiais</a></li>
      <li class="nav-item"><a href="{{ url_for('main.relatorios') }}" class="nav-link {% if request.endpoint == 'main.relatorios' %}active{% endif %} text-white"><i class="bi bi-file-earmark-text me-2"></i>Relatórios</a></li>
    </ul>
  </li>

  <!-- Patrimônio -->
  <li class="nav-item mt-3">
    <a class="nav-link text-white fw-bold d-flex justify-content-between align-items-center"
       data-bs-toggle="collapse" href="#submenuPatrimonio" role="button"
       aria-expanded="{% if request.endpoint.startswith('patrimonio_bp') %}true{% else %}false{% endif %}">
      <span><i class="bi bi-building me-1"></i> Patrimônio</span><i class="bi bi-chevron-down"></i>
    </a>
    <ul class="collapse nav flex-column ms-3 {% if request.endpoint.startswith('patrimonio_bp') %}show{% endif %}" id="submenuPatrimonio">
      <li class="nav-item"><a href="{{ url_for('patrimonio_bp.listar_bens') }}" class="nav-link {% if request.endpoint == 'patrimonio_bp.listar_bens' %}active{% endif %} text-white"><i class="bi bi-collection me-2"></i>Bens Patrimoniais</a></li>
      <li class="nav-item"><a href="#" class="nav-link text-white disabled"><i class="bi bi-clipboard-check me-2"></i>Inventário</a></li>
      <li class="nav-item"><a href="#" class="nav-link text-white disabled"><i class="bi bi-arrow-left-right me-2"></i>Transferência</a></li>
      <li class="nav-item"><a href="#" class="nav-link text-white disabled"><i class="bi bi-file-earmark-text me-2"></i>Relatórios</a></li>
    </ul>
  </li>

  <!-- Compras -->
  <li class="nav-item mt-3">
    <a class="nav-link text-white fw-bold d-flex justify-content-between align-items-center"
       data-bs-toggle="collapse" href="#submenuCompras" role="button"
       aria-expanded="{% if request.endpoint.startswith('painel_bp') %}true{% else %}false{% endif %}">
      <span><i class="bi bi-cart-check me-1"></i> Compras</span><i class="bi bi-chevron-down"></i>
    </a>
    <ul class="collapse nav flex-column ms-3 {% if request.endpoint.startswith('painel_bp') %}show{% endif %}" id="submenuCompras">
      <li class="nav-item"><a href="{{ url_for('painel_bp.lista_painel') }}" class="nav-link {% if request.endpoint == 'painel_bp.lista_painel' %}active{% endif %} text-white"><i class="bi bi-grid me-2"></i>Painel de Contratações</a></li>
      <li class="nav-item"><a href="#" class="nav-link text-white disabled"><i class="bi bi-file-earmark-text me-2"></i>Requisições</a></li>
      <li class="nav-item"><a href="#" class="nav-link text-white disabled"><i class="bi bi-shop me-2"></i>Fornecedores</a></li>
      <li class="nav-item"><a href="#" class="nav-link text-white disabled"><i class="bi bi-cash-coin me-2"></i>Cotações</a></li>
      <li class="nav-item"><a href="#" class="nav-link text-white disabled"><i class="bi bi-folder me-2"></i>Processos SEI</a></li>
    </ul>
  </li>

  <!-- Publicações -->
  <li class="nav-item mt-3">
    <a class="nav-link text-white fw-bold d-flex justify-content-between align-items-center"
       data-bs-toggle="collapse" href="#submenuPublicacoes" role="button"
       aria-expanded="{% if request.endpoint.startswith('publicacoes') %}true{% else %}false{% endif %}">
      <span><i class="bi bi-journal-text me-1"></i> Publicações</span><i class="bi bi-chevron-down"></i>
    </a>
    <ul class="collapse nav flex-column ms-3 {% if request.endpoint.startswith('publicacoes') %}show{% endif %}" id="submenuPublicacoes">
      <li class="nav-item">
        <a href="{{ url_for('publicacao_bp.listar') }}" 
           class="nav-link {% if request.endpoint == 'publicacao_bp.listar' %}active{% endif %} text-white">
          <i class="bi bi-list-ul me-2"></i>Lista de Publicações
        </a>
      </li>
      <li class="nav-item">
        <a href="{{ url_for('publicacao_bp.nova_publicacao') }}" 
           class="nav-link {% if request.endpoint == 'publicacao_bp.nova_publicacao' %}active{% endif %} text-white">
          <i class="bi bi-plus-circle me-2"></i>Nova Publicação
        </a>
      </li>
    </ul>
  </li>

  <!-- Tarefas -->
  <li class="nav-item mt-3">
    <a class="nav-link text-white fw-bold d-flex justify-content-between align-items-center"
       data-bs-toggle="collapse" href="#submenuTarefas" role="button"
       aria-expanded="{% if request.endpoint.startswith('tarefas') %}true{% else %}false{% endif %}">
      <span><i class="bi bi-list-task me-1"></i> Tarefas</span><i class="bi bi-chevron-down"></i>
    </a>
    <ul class="collapse nav flex-column ms-3 {% if request.endpoint.startswith('tarefas') %}show{% endif %}" id="submenuTarefas">
      <li class="nav-item">
        <a href="{{ url_for('tarefas.lista_tarefas') }}" 
           class="nav-link {% if request.endpoint == 'tarefas.lista_tarefas' %}active{% endif %} text-white">
          <i class="bi bi-kanban me-1"></i> Quadro Kanban
        </a>
      </li>
      <li class="nav-item">
        <a href="{{ url_for('tarefas.nova_tarefa') }}" 
           class="nav-link {% if request.endpoint == 'tarefas.nova_tarefa' %}active{% endif %} text-white">
          <i class="bi bi-plus-circle me-1"></i> Nova Tarefa
        </a>
      </li>
    </ul>
  </li>

  <!-- Dashboard -->
  <li class="nav-item mt-3">
    <a href="{{ url_for('dashboard_bp.dashboard') }}" class="nav-link {% if request.endpoint == 'dashboard_bp.dashboard' %}active{% endif %} text-white fw-bold">
      <i class="bi bi-graph-up-arrow me-1"></i> Dashboard
    </a>
  </li>

  <!-- Configurações -->
  <li class="nav-item mt-3">
    <a class="nav-link text-white fw-bold d-flex justify-content-between align-items-center"
       data-bs-toggle="collapse" href="#submenuConfig" role="button"
       aria-expanded="{% if request.endpoint.startswith('usuario_bp') or request.endpoint.startswith('nd_bp') or request.endpoint.startswith('grupo_bp') or request.endpoint.startswith('area_ul_bp') %}true{% else %}false{% endif %}">
      <span><i class="bi bi-gear me-1"></i> Configurações</span><i class="bi bi-chevron-down"></i>
    </a>
    <ul class="collapse nav flex-column ms-3 {% if request.endpoint.startswith('usuario_bp') or request.endpoint.startswith('nd_bp') or request.endpoint.startswith('grupo_bp') or request.endpoint.startswith('area_ul_bp') %}show{% endif %}" id="submenuConfig">
      <li class="nav-item"><a href="{{ url_for('usuario_bp.lista_usuarios') }}" class="nav-link {% if request.endpoint == 'usuario_bp.lista_usuarios' %}active{% endif %} text-white"><i class="bi bi-people me-2"></i>Perfis e Usuários</a></li>
      <li class="nav-item mt-2 text-white-50 small">Organização Administrativa</li>
      <li class="nav-item"><a href="{{ url_for('nd_bp.lista_nd') }}" class="nav-link {% if request.endpoint == 'nd_bp.lista_nd' %}active{% endif %} text-white"><i class="bi bi-currency-dollar me-2"></i>Natureza de Despesa</a></li>
      <li class="nav-item"><a href="{{ url_for('grupo_bp.lista_grupos') }}" class="nav-link {% if request.endpoint == 'grupo_bp.lista_grupos' %}active{% endif %} text-white"><i class="bi bi-diagram-3 me-2"></i>Grupos</a></li>
      <li class="nav-item"><a href="{{ url_for('area_ul_bp.lista_locais') }}" class="nav-link {% if request.endpoint == 'area_ul_bp.lista_locais' %}active{% endif %} text-white"><i class="bi bi-geo-alt me-2"></i>Áreas</a></li>
      <li class="nav-item"><a href="{{ url_for('area_ul_bp.lista_uls') }}" class="nav-link {% if request.endpoint == 'area_ul_bp.lista_uls' %}active{% endif %} text-white"><i class="bi bi-building me-2"></i>Unidades Locais</a></li>
      
      <li class="nav-item mt-2 text-white-50 small">Configurações de Tarefas</li>
      <li class="nav-item"><a href="{{ url_for('config_tarefas.lista_categorias') }}" class="nav-link {% if request.endpoint == 'config_tarefas.lista_categorias' %}active{% endif %} text-white"><i class="bi bi-tag me-2"></i>Categorias</a></li>
      <li class="nav-item"><a href="{{ url_for('config_tarefas.lista_origens') }}" class="nav-link {% if request.endpoint == 'config_tarefas.lista_origens' %}active{% endif %} text-white"><i class="bi bi-flag me-2"></i>Origens</a></li>
    </ul>
  </li>

  <!-- Auditoria (somente admin) -->
  {% if usuario and usuario.email == 'admin@admin.com' %}
  <li class="nav-item mt-3">
    <a href="{{ url_for('auditoria_bp.lista_logs') }}" class="nav-link {% if request.endpoint == 'auditoria_bp.lista_logs' %}active{% endif %} text-white fw-bold">
      <i class="bi bi-shield-lock me-1"></i> Auditoria
    </a>
  </li>
  {% endif %}
</ul> 
